<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Control Panel</title>
    <script src="/socket.io/socket.io.js"></script>
    <style>
        body { background: #121212; color: #e0e0e0; font-family: 'Segoe UI', sans-serif; padding: 20px; display: flex; justify-content: center; }
        .panel { background: #1e1e1e; padding: 25px; border-radius: 12px; width: 100%; max-width: 480px; box-shadow: 0 4px 20px rgba(0,0,0,0.5); border: 1px solid #333; }
        
        h2 { color: #00eaff; margin-top: 0; border-bottom: 2px solid #333; padding-bottom: 10px; font-size: 18px; text-align: center; }
        .section-title { font-size: 12px; color: #888; text-transform: uppercase; letter-spacing: 1px; margin: 20px 0 10px 0; font-weight: bold; border-bottom: 1px solid #333; padding-bottom: 5px; }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª */
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px; }
        .stat-card { background: #252525; padding: 10px; border-radius: 8px; text-align: center; border: 1px solid #333; }
        .stat-val { font-size: 24px; font-weight: bold; color: white; }
        .stat-lbl { font-size: 11px; color: #aaa; }
        .record-lbl { font-size: 10px; color: #FFD700; margin-top: 5px; }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .btn { width: 100%; padding: 12px; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; transition: 0.2s; font-size: 13px; }
        .btn-save { background: #00eaff; color: #000; width: 100%; margin-top: 20px; font-size: 16px; }
        .btn-save:hover { transform: scale(1.02); }
        .btn-reset { background: #2a1a1a; color: #ff4444; border: 1px solid #ff4444; }
        .btn-reset:hover { background: #ff4444; color: white; }
        .btn-reset-rec { background: #2a1a1a; color: #FFD700; border: 1px solid #FFD700; } 
        .btn-reset-rec:hover { background: #FFD700; color: black; }

        /* Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª */
        .group { margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; }
        label { font-size: 13px; color: #ccc; }
        input, select { background: #333; border: 1px solid #444; color: white; padding: 6px; border-radius: 4px; }
        input[type="color"] { width: 40px; height: 30px; padding: 0; border: none; cursor: pointer; }
        input[type="number"] { width: 70px; }
        input[type="text"] { width: 120px; font-weight: bold; }
        
        #status { text-align: center; margin-top: 15px; font-size: 12px; color: #666; }
    </style>
</head>
<body>
    <div class="panel">
        <h2>ğŸ›ï¸ COMMAND CENTER</h2>
        
        <div class="stats-grid">
            <div class="stat-card" style="border-bottom: 3px solid #00eaff;">
                <div class="stat-lbl">CURRENT WIN</div><div class="stat-val" id="liveWin">0</div>
                <div class="record-lbl">ğŸ† Best: <span id="recWin">0</span></div>
            </div>
            <div class="stat-card" style="border-bottom: 3px solid #ff0055;">
                <div class="stat-lbl">CURRENT LOSS</div><div class="stat-val" id="liveLoss">0</div>
                <div class="record-lbl">ğŸ’€ Worst: <span id="recLoss">0</span></div>
            </div>
        </div>

        <div class="btn-grid">
            <button class="btn btn-reset" onclick="api('reset')">âš  RESET SCORES</button>
            <button class="btn btn-reset-rec" onclick="api('reset_records')">ğŸ† RESET RECORDS</button>
        </div>

        <div class="section-title">ğŸ“ Text & Colors</div>
        <div class="group"><label>Win Label</label><input type="text" id="winText"></div>
        <div class="group"><label>Loss Label</label><input type="text" id="lossText"></div>
        <div class="group"><label>Win Color</label><input type="color" id="winColor"></div>
        <div class="group"><label>Loss Color</label><input type="color" id="lossColor"></div>
        <div class="group"><label>Background</label><input type="color" id="bgColor"></div>
        <div class="group"><label>Text Color</label><input type="color" id="labelColor"></div>
        <div class="group"><label>Number Color</label><input type="color" id="numColor"></div>

        <div class="section-title">ğŸ“ Advanced Styling</div>
        <div class="group"><label>Width (px)</label><input type="number" id="width"></div>
        <div class="group"><label>Height (px)</label><input type="number" id="height"></div>
        <div class="group"><label>Border Width</label><input type="number" id="borderWidth" min="0" max="20"></div>
        <div class="group"><label>Border Radius</label><input type="number" id="borderRadius" min="0" max="50"></div>
        <div class="group"><label>Shadow Opacity</label><input type="number" id="shadowOpacity" step="0.1" min="0" max="1"></div>
        <div class="group"><label>Layout Mode</label>
            <select id="layout">
                <option value="row">Horizontal (English)</option>
                <option value="column">Vertical</option>
                <option value="rtl">Horizontal (Arabic)</option>
            </select>
        </div>

        <button class="btn btn-save" onclick="saveSettings()">ğŸ’¾ SAVE DESIGN CHANGES</button>
        <div id="status">Connecting...</div>
    </div>

    <script>
        const socket = io();

        // 1. ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø­ÙŠØ©
        socket.on('update_scores', (data) => {
            document.getElementById('liveWin').innerText = data.win;
            document.getElementById('liveLoss').innerText = data.loss;
            document.getElementById('recWin').innerText = data.rec_win;
            document.getElementById('recLoss').innerText = data.rec_loss;
        });

        // 2. ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
        socket.on('update_settings', (s) => {
            setVal('winText', s.winText); setVal('lossText', s.lossText);
            setVal('winColor', s.winColor); setVal('lossColor', s.lossColor);
            setVal('bgColor', s.bgColor); setVal('labelColor', s.labelColor); setVal('numColor', s.numColor);
            setVal('width', s.width); setVal('height', s.height);
            // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
            setVal('borderWidth', s.borderWidth !== undefined ? s.borderWidth : 4);
            setVal('borderRadius', s.borderRadius !== undefined ? s.borderRadius : 6);
            setVal('shadowOpacity', s.shadowOpacity !== undefined ? s.shadowOpacity : 0.5);
            setVal('layout', s.layout);
            
            document.getElementById('status').innerText = "âœ… Connected & Synced";
        });

        // 3. Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        function saveSettings() {
            const newSettings = {
                winText: getVal('winText'), lossText: getVal('lossText'),
                winColor: getVal('winColor'), lossColor: getVal('lossColor'),
                bgColor: getVal('bgColor'), labelColor: getVal('labelColor'), numColor: getVal('numColor'),
                width: getVal('width'), height: getVal('height'), layout: getVal('layout'),
                // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
                borderWidth: getVal('borderWidth'), 
                borderRadius: getVal('borderRadius'), 
                shadowOpacity: getVal('shadowOpacity'),
                // Ù‚ÙŠÙ… Ø«Ø§Ø¨ØªØ©
                gap: 15, fontFamily: "'Cairo', sans-serif", labelSize: 30, numSize: 35 
            };
            socket.emit('save_settings', newSettings);
            document.getElementById('status').innerText = "ğŸ’¾ Saved!";
            setTimeout(() => document.getElementById('status').innerText = "âœ… Synced", 2000);
        }

        // Ø¯Ø§Ù„Ø© Ø§Ù„ØªØµÙÙŠØ±
        function api(action) {
            let msg = action === 'reset' ? "Reset current scores?" : "Reset RECORD history?";
            if(confirm(msg)) {
                fetch(`/api/set?action=${action}`);
            }
        }

        function setVal(id, v) { if(document.getElementById(id)) document.getElementById(id).value = v; }
        function getVal(id) { return document.getElementById(id).value; }
    </script>
</body>
</html>
